{"version":3,"sources":["routes.js","Directives/capitalize.js","Directives/enter.js","Directives/materialSelect.js","Directives/rightClick.js","Filters/crlf.js","Filters/reverse.js","Filters/tableFilter.js","Filters/total-montant.js","Services/actionIntervention.js","Services/address.js","Services/api.js","Services/config.js","Services/contextMenu.js","Services/dataProvider.js","Services/dialog.js","Services/fourniture.js","Services/interActions.js","Services/map.js","Services/mapAutocomplete.js","Services/openPost.js","Services/productsList.js","Services/socketFactory.js","Services/tabs.js","Services/taskList.js","Services/whoAmI.js","Pages/Artisan/artisanController.js","Pages/Dashboard/dashboardController.js","Pages/Intervention/interventionController.js","Pages/ListeInterventions/artisansStatsController.js","Pages/ListeInterventions/listeInterventionsController.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChDA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrJA;AACA;AACA;AACA;AACA;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvBA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrBA;AACA;AACA;AACA;AACA;AACA;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzRA;AACA;AACA;AACA;AACA;AACA;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"all.js","sourcesContent":["angular.module('edison', ['browserify', 'ngMaterial', 'lumx', 'ngAnimate', 'xeditable', 'ngDialog', 'btford.socket-io', 'ngFileUpload', 'pickadate', 'ngRoute', 'ngResource', 'ngTable', 'ngMap'])\n    .config(function($mdThemingProvider) {\n        \"use strict\";\n        $mdThemingProvider.theme('default')\n            .primaryPalette('indigo')\n            .accentPalette('blue-grey');\n    });\n\n\nangular.module('edison').controller('MainController', function(tabContainer, $scope, socket, config, dataProvider, $rootScope, $location, edisonAPI, taskList) {\n    \"use strict\";\n    $scope.config = config;\n    $rootScope.loadingData = true;\n    $rootScope.$on('$routeChangeSuccess', function() {\n        $rootScope.loadingData = false;\n    });\n\n    $scope.sideBarlinks = [{\n        url: '/dashboard',\n        title: 'Dashboard',\n        icon: 'dashboard'\n    }, {\n        url: '/intervention',\n        title: 'Nouvelle Intervention',\n        icon: 'plus'\n    }];\n    $scope.tabs = tabContainer;\n    $scope.$watch('tabs.selectedTab', function(prev, curr) {\n        if (prev === -1 && curr !== -1) {\n            $scope.tabs.selectedTab = curr;\n        }\n    });\n    $rootScope.options = {\n        showMap: true\n    };\n\n    var reloadStats = function() {\n\n        edisonAPI.intervention.getStats()\n            .success(function(result) {\n                $scope.userStats = _.find(result, function(e) {\n                    return e.login === $scope.user.login;\n                });\n                $scope.interventionsStats = result;\n            });\n    };\n\n    edisonAPI.getUser().success(function(result) {\n        $rootScope.user = result;\n        reloadStats();\n    });\n\n\n    $rootScope.$on('InterventionListChange', reloadStats);\n\n    var initTabs = function(baseUrl) {\n        $scope.tabsInitialized = true;\n        $scope.tabs.loadSessionTabs(baseUrl)\n            .then(function() {\n                $location.url(baseUrl);\n            }).catch(function() {\n                $scope.tabs.addTab(baseUrl);\n            });\n        return 0;\n    };\n\n    $scope.$on(\"$locationChangeStart\", function(event) {\n        if (!event) {\n            edisonAPI.request({\n                fn: 'setSessionData',\n                data: {\n                    tabContainer: $scope.tabs\n                }\n            });\n\n        }\n        if ($location.path() === \"/\") {\n            return 0;\n        }\n        if (!$scope.tabsInitialized) {\n            return initTabs($location.path());\n        }\n        if ($location.path() !== \"/intervention\") {\n            $scope.tabs.addTab($location.path());\n        }\n\n    });\n\n    $scope.taskList = taskList;\n\n    $scope.linkClick = function($event) {\n        $event.preventDefault();\n        $event.stopPropagation();\n    };\n\n    $scope.tabIconClick = function($event, tab) {\n        $event.preventDefault();\n        $event.stopPropagation();\n        if ($scope.tabs.remove(tab)) {\n            $location.url($scope.tabs.getCurrentTab().url);\n        }\n    };\n});\n\nvar getInterList = function(edisonAPI) {\n    \"use strict\";\n    return edisonAPI.intervention.list({\n        cache: true\n    });\n};\nvar getArtisanList = function(edisonAPI) {\n    \"use strict\";\n    return edisonAPI.artisan.list({\n        cache: true\n    });\n};\n\nvar getArtisan = function($route, $q, edisonAPI) {\n    \"use strict\";\n    var id = $route.current.params.id;\n\n    if (id.length > 10) {\n        return $q(function(resolve) {\n            resolve({\n                data: {\n                    telephone: {},\n                    pourcentage: {},\n                    add: {},\n                    representant: {},\n                }\n            });\n        });\n    } else {\n        return edisonAPI.artisan.get(id, {\n            cache: true,\n            extend: true\n        });\n    }\n};\n\nvar getInterventionStats = function(edisonAPI) {\n    \"use strict\";\n    return edisonAPI.intervention.getStats();\n};\n\nvar getIntervention = function($route, $q, edisonAPI) {\n    \"use strict\";\n    var id = $route.current.params.id;\n\n    if (id.length > 10) {\n        return $q(function(resolve) {\n            resolve({\n                data: {\n                    prixAnnonce: 0,\n                    prixFinal: 0,\n                    coutFourniture: 0,\n                    comments: [],\n                    produits: [],\n                    tva: 20,\n                    client: {},\n                    reglementSurPlace: true,\n                    date: {\n                        ajout: Date.now(),\n                        intervention: Date.now()\n                    }\n                }\n            });\n        });\n    } else {\n        return edisonAPI.intervention.get(id, {\n            cache: true,\n            extend: true\n        });\n    }\n};\n\n\n\nangular.module('edison').config(function($routeProvider, $locationProvider) {\n    \"use strict\";\n    $routeProvider\n        .when('/', {\n            resolve: {\n                interventions: getInterList,\n                artisans: getArtisanList\n            },\n            redirectTo: '/interventions',\n        })\n        .when('/artisan/:id', {\n            templateUrl: \"Pages/Artisan/artisan.html\",\n            controller: \"ArtisanController\",\n            resolve: {\n                artisan: getArtisan,\n                interventions: getInterList,\n                artisans: getArtisanList\n            }\n        })\n        .when('/interventions', {\n            templateUrl: \"Pages/ListeInterventions/listeInterventions.html\",\n            controller: \"InterventionsController\",\n            resolve: {\n                interventions: getInterList,\n                interventionsStats: getInterventionStats,\n                artisans: getArtisanList\n            }\n        })\n        .when('/interventions/:fltr', {\n            templateUrl: \"Pages/ListeInterventions/listeInterventions.html\",\n            controller: \"InterventionsController\",\n            resolve: {\n                interventionsStats: getInterventionStats,\n                interventions: getInterList,\n                artisans: getArtisanList\n            }\n        })\n        .when('/intervention', {\n            redirectTo: function() {\n                return '/intervention/' + Date.now();\n            }\n        })\n        .when('/artisan', {\n            redirectTo: function() {\n                return '/artisan/' + Date.now();\n            }\n        })\n        .when('/artisan/:artisanID/recap', {\n            templateUrl: \"Pages/ListeInterventions/listeInterventions.html\",\n            controller: \"InterventionsController\",\n            resolve: {\n                interventionsStats: getInterventionStats,\n                interventions: getInterList,\n                artisans: getArtisanList\n            }\n        })\n        .when('/intervention/:id', {\n            templateUrl: \"Pages/Intervention/intervention.html\",\n            controller: \"InterventionController\",\n            controllerAs: \"vm\",\n            resolve: {\n                interventions: getInterList,\n                intervention: getIntervention,\n                artisans: getArtisanList\n\n            }\n        })\n        .when('/dashboard', {\n            controller: 'DashboardController',\n            templateUrl: \"Pages/Dashboard/dashboard.html\",\n            resolve: {\n                interventions: getInterList,\n                artisans: getArtisanList\n\n            }\n        })\n        .otherwise({\n            templateUrl: 'templates/Error404.html',\n        });\n    // use the HTML5 History API\n    $locationProvider.html5Mode(true);\n});\n\nangular.module('edison').run(function(editableOptions) {\n    \"use strict\";\n    editableOptions.theme = 'bs3'; // bootstrap3 theme. Can be also 'bs2', 'default'\n});\n","angular.module('edison').directive('capitalize', function() {\n    \"use strict\";\n    return {\n        require: 'ngModel',\n        link: function(scope, element, attrs, modelCtrl) {\n            modelCtrl.$parsers.push(function(input) {\n                return input ? input.toUpperCase() : \"\";\n            });\n            element.css(\"text-transform\", \"uppercase\");\n        }\n    };\n});\n","angular.module('edison').directive('ngEnter', function () {\n    \"use strict\";\n    return function (scope, element, attrs) {\n        element.bind(\"keydown keypress\", function (event) {\n            if(event.which === 13) {\n                scope.$apply(function (){\n                    scope.$eval(attrs.ngEnter);\n                });\n\n                event.preventDefault();\n            }\n        });\n    };\n});","/*angular.module('edison').directive('materialSelect', function() {\n  return {\n    restrict: 'E',\n    replace: true,\n    template: '<div class=\"select-style text-field\">' +\n      '<select ng-model>' +\n      '<option disabled>{{defaultName}}</option>' +\n      '</select>' +\n      '</div>'\n  }\n});\n*/","angular.module('edison').directive('ngRightClick', function($parse) {\n    \"use strict\";\n    return function(scope, element, attrs) {\n        var fn = $parse(attrs.ngRightClick);\n        element.bind('contextmenu', function(event) {\n            scope.$apply(function() {\n                event.preventDefault();\n                fn(scope, {\n                    $event: event\n                });\n            });\n        });\n    };\n});\n","angular.module('edison').filter('crlf', function() {\n\t\"use strict\";\n    return function(text) {\n        return text.split(/\\n/g).join('<br>');\n    };\n});\n","angular.module('edison').filter('reverse', function() {\n    \"use strict\";\n    return function(items) {\n        if (!items)\n            return [];\n        return items.slice().reverse();\n    };\n});\n","angular.module(\"edison\").filter('tableFilter', function() {\n    \"use strict\";\n\n    var clean = function(str) {\n        return _.deburr(str).toLowerCase();\n    }\n\n    var compare = function(a, b) {\n        if (typeof a === \"string\") {\n            return clean(a).includes(b);\n        } else {\n            return clean(String(a)).startsWith(b);\n        }\n    }\n\n    return function(dataContainer, inputs) {\n        var rtn = [];\n        console.time('fltr')\n        inputs = _.mapValues(inputs, clean);\n        _.each(dataContainer, function(data) {\n            if (data.id) {\n                var psh = true;\n                _.each(inputs, function(input, k) {\n                    if (input && input.length > 0 && !compare(data[k], input)) {\n                        psh = false;\n                        return false\n                    }\n                });\n                if (psh === true) {\n                    rtn.push(data);\n                }\n            }\n        })\n        console.timeEnd('fltr')\n\n        return rtn;\n    }\n});\n","angular.module('edison').filter('total', function() {\n    \"use strict\";\n    return function(obj) {\n        if (obj && obj.total) {\n        \treturn obj.total;\n        }\n        return \"0\";\n    };\n});\n\nangular.module('edison').filter('montant', function() {\n    \"use strict\";\n    return function(obj) {\n        if (obj && obj.montant) {\n        \treturn (obj.montant > 999 ? (obj.montant / 1000).toFixed(0) + 'k' : obj.montant.toFixed(0)) + '€';\n        }\n        return \"0€\";\n    };\n});\n","angular.module('edison')\n    .factory('actionIntervention', ['$window', 'LxNotificationService', 'dialog', 'edisonAPI',\n        function($window, LxNotificationService, dialog, edisonAPI) {\n            \"use strict\";\n            return {\n                envoiDevis: function(inter, cb) {\n                    dialog.getText({\n                        title: \"Texte envoi devis\",\n                        text: _.template(\"Voici le devis de l'inter {{id}}\\nEdison Services\")(inter)\n                    }, function(text) {\n                        edisonAPI.intervention.envoiDevis(inter.id, {\n                            text: text,\n                            data: inter,\n                        }).success(function(resp) {\n                            var validationMessage = _.template(\"le devis de l'intervention {{id}} à été envoyé\")(inter);\n                            LxNotificationService.success(validationMessage);\n                            if (typeof cb === 'function')\n                                cb(null, resp);\n                        }).catch(function(err) {\n                            var validationMessage = _.template(\"L'envoi du devis {{id}} à échoué\")(inter)\n                            LxNotificationService.error(validationMessage);\n                            if (typeof cb === 'function')\n                                cb(err);\n                        })\n\n                    })\n                },\n                envoiFacture: function(inter, cb) {\n                    dialog.envoiFacture(inter, function(text, acquitte, date) {\n                        edisonAPI.intervention.envoiFacture(inter.id, {\n                            text: text,\n                            acquitte: acquitte,\n                            date: date,\n                            data: inter,\n                        }).success(function(resp) {\n                            var validationMessage = _.template(\"La facture de l'intervention {{id}} à été envoyé\")(inter)\n                            LxNotificationService.success(validationMessage);\n                            if (typeof cb === 'function')\n                                cb(null, resp);\n                        }).catch(function(err) {\n                            var validationMessage = _.template(\"L'envoi de la facture {{id}} à échoué\")(inter)\n                            LxNotificationService.error(validationMessage);\n                            if (typeof cb === 'function')\n                                cb(err);\n                        })\n\n                    })\n                },\n                smsArtisan: function(inter, cb) {\n                    dialog.getText({\n                        title: \"Texte du SMS\",\n                        text: \"\\nEdison Service\"\n                    }, function(text) {\n                        edisonAPI.sms.save({\n                            link: inter.artisan.id,\n                            origin: inter.id || inter.tmpID,\n                            text: text,\n                            to: \"0633138868\"\n                        }).success(function(resp) {\n                            if (typeof cb === 'function')\n                                cb(null, resp);\n                        }).catch(function(err) {\n                            if (typeof cb === 'function')\n                                cb(err);\n                        })\n                    })\n                },\n                callArtisan: function(inter, cb) {\n                    var now = Date.now();\n                    $window.open('callto:' + inter.artisan.telephone.tel1, '_self', false)\n                    dialog.choiceText({\n                        title: 'Nouvel Appel',\n                    }, function(response, text) {\n                        edisonAPI.call.save({\n                            date: now,\n                            to: inter.artisan.telephone.tel1,\n                            link: inter.artisan.id,\n                            origin: inter.id || inter.tmpID || 0,\n                            description: text,\n                            response: response\n                        }).success(function(resp) {\n                            if (typeof cb === 'function')\n                                cb(null, resp);\n                        }).catch(function(err) {\n                            if (typeof cb === 'function')\n                                cb(err);\n                        })\n                    })\n                },\n                save: function(inter, cb) {\n                    edisonAPI.intervention.save(inter)\n                        .then(function(resp) {\n                            console.log(\"yey\")\n                            var validationMessage = _.template(\"Les données de l'intervention {{id}} ont à été enregistré\")(resp.data)\n                            LxNotificationService.success(validationMessage);\n                            if (typeof cb === 'function')\n                                cb(null, resp.data)\n                        }).catch(function(error) {\n                            LxNotificationService.error(error.data);\n                            if (typeof cb === 'function')\n                                cb(error.data)\n                        });\n                },\n                envoi: function(inter, cb) {\n                    dialog.getFileAndText(inter, inter.files, function(text, file) {\n                        edisonAPI.intervention.envoi(inter.id, {\n                            sms: text,\n                            file: file\n                        }).then(function(resp) {\n                            var validationMessage = _.template(\"L'intervention {{id}} est envoyé\")(resp.data)\n                            LxNotificationService.success(validationMessage);\n                            if (typeof cb === 'function')\n                                cb(null, resp.data)\n\n                        }).catch(function(error) {\n                            LxNotificationService.error(error.data);\n                            if (typeof cb === 'function')\n                                cb(error.data);\n                        });\n                    })\n                },\n                annulation: function(inter, cb) {\n                    edisonAPI.intervention.annulation(inter.id)\n                        .then(function(resp) {\n                            console.log(resp.data)\n                            var validationMessage = _.template(\"L'intervention {{id}} est annulé\")(resp.data)\n                            LxNotificationService.success(validationMessage);\n                            if (typeof cb === 'function')\n                                cb(null, resp.data)\n                        });\n                },\n                verification: function(inter, cb) {\n                    edisonAPI.intervention.verification(inter.id)\n                        .then(function(resp) {\n                            var validationMessage = _.template(\"L'intervention {{id}} est vérifié\")(resp.data)\n                            LxNotificationService.success(validationMessage);\n                            if (typeof cb === 'function')\n                                cb(resp.data);\n                        }).catch(function(error) {\n                            LxNotificationService.error(error.data);\n                            if (typeof cb === 'function')\n                                cb(error.data);\n                        })\n                }\n            }\n        }\n    ]);\n","angular.module('edison').factory('Address', function() {\n    \"use strict\";\n\n    var Address = function(place, copyContructor) {\n        if (place.lat && place.lng) {\n            this.lt = place.lat;\n            this.lg = place.lng;\n        } else if (copyContructor) {\n            this.getAddressProprieties(place);\n            this.streetAddress = true;\n        } else if (this.isStreetAddress(place)) {\n            this.getPlaceProprieties(place);\n        } else if (this.isLocalityAddress(place)) {\n            this.getPlaceLocalityProprieties(place);\n        }\n        if (place.geometry) {\n            this.lt = place.geometry.location.lat();\n            this.lg = place.geometry.location.lng();\n        }\n        this.latLng = this.lt + ', ' + this.lg;\n    };\n\n    Address.prototype.getPlaceLocalityProprieties = function(place) {\n        var a = place.address_components;\n        this.cp = a[1] && a[1].short_name;\n        this.v = a[0] && a[0].short_name;\n    }\n\n    Address.prototype.getPlaceProprieties = function(place) {\n        var a = place.address_components;\n        this.n = a[0] && a[0].short_name;\n        this.r = a[1] && a[1].short_name;\n        this.cp = a[6] && a[6].short_name;\n        this.v = a[2] && a[2].short_name;\n    }\n\n    Address.prototype.getAddressProprieties = function(address) { \n        this.n = address.n;\n        this.r = address.r;\n        this.cp = address.cp;\n        this.v = address.v;\n        this.lt = address.lt;\n        this.lg = address.lg;\n        this.code = address.code;\n        this.etage = address.etage;\n    }\n\n    Address.prototype.isLocalityAddress = function(place) {\n        this.localityAddress = (place.types.indexOf(\"locality\") >= 0);\n        return this.localityAddress;\n    }\n\n    Address.prototype.isStreetAddress = function(place) {\n        var noStreet = [\"locality\", \"country\", \"postal_code\", \"route\", \"sublocality\"];\n        this.streetAddress = (noStreet.indexOf(place.types[0]) < 0);\n        return (this.streetAddress);\n    }\n\n    Address.prototype.toString = function() {\n        return (this.n + \" \" + this.r + \" \" + this.cp + \", \" + this.v + \", France\")\n    }\n\n    return (function(place, copyContructor) {\n        return new Address(place, copyContructor);\n    })\n});\n","angular.module('edison').factory('edisonAPI', ['$http', '$location', 'dataProvider', 'Upload', function($http, $location, dataProvider, Upload) {\n    \"use strict\";\n    return {\n        intervention: {\n            getStats: function() {\n                return $http({\n                    method: 'GET',\n                    cache: false,\n                    url: '/api/intervention/stats'\n                })\n            },\n            list: function(options) {\n                return $http({\n                    method: 'GET',\n                    cache: options && options.cache,\n                    url: '/api/intervention/list'\n                })\n            },\n            get: function(id, options) {\n                return $http({\n                    method: 'GET',\n                    cache: false,\n                    url: '/api/intervention/' + id,\n                    params: options || {}\n                }).success(function(result) {\n                    return result;\n                });\n            },\n            save: function(params) {\n                return $http.post(\"/api/intervention\", params);\n            },\n            getFiles: function(id) {\n                return $http({\n                    method: 'GET',\n                    url: \"/api/intervention/\" + id + \"/getFiles\"\n                });\n            },\n            verification: function(id, options) {\n                return $http.post(\"/api/intervention/\" + id + \"/verification\", options);\n            },\n            annulation: function(id) {\n                return $http.post(\"/api/intervention/\" + id + \"/annulation\");\n            },\n            envoi: function(id, options) {\n                return $http.post(\"/api/intervention/\" + id + \"/envoi\", options);\n            },\n            envoiFacture: function(id, options) {\n                return $http.post(\"/api/intervention/\" + id + \"/envoiFacture\", options);\n            },\n             envoiDevis: function(id, options) {\n                return $http.post(\"/api/intervention/\" + id + \"/envoiDevis\", options);\n            },\n        },\n        artisan: {\n            list: function(options) {\n                return $http({\n                    method: 'GET',\n                    cache: options && options.cache,\n                    url: '/api/artisan/list'\n                }).success(function(result) {\n                    return result;\n                })\n            },\n            lastInters: function(id) {\n                return $http({\n                    method: 'GET',\n                    url: '/api/artisan/' + id + '/lastInters',\n                })\n            },\n            get: function(id, options) {\n                return $http({\n                    method: 'GET',\n                    cache: options && options.cache,\n                    url: '/api/artisan/' + id,\n                    params: options || {}\n                }).success(function(result) {\n                    return result;\n                });\n            },\n            getNearest: function(address, categorie) {\n                return $http({\n                    method: 'GET',\n                    url: \"/api/artisan/rank\",\n                    cache: false,\n                    params: {\n                        categorie: categorie,\n                        lat: address.lt,\n                        lng: address.lg,\n                        limit: 50,\n                        maxDistance: 50\n                    }\n                });\n            },\n            getStats: function(id_sst) {\n                return $http({\n                    method: 'GET',\n                    url: \"/api/artisan/\" + id_sst + \"/stats\"\n                });\n            },\n            setAbsence: function(id, options) {\n                return $http({\n                    method: 'GET',\n                    url: '/api/artisan/' + id + '/absence',\n                    params: options\n                })\n            },\n        },\n        task: {\n            get: function(params) {\n                return $http({\n                    method: 'GET',\n                    url: '/api/taks/get',\n                    params: params\n                })\n            },\n            add: function(params) {\n                return $http({\n                    method: 'GET',\n                    url: '/api/task/add',\n                    params: params\n                })\n            },\n            check: function(params) {\n                return $http({\n                    method: 'GET',\n                    url: '/api/task/add',\n                    params: params\n                })\n            },\n        },\n        file: {\n            upload: function(file, options) {\n                return Upload.upload({\n                    url: '/api/document/upload',\n                    fields: options,\n                    file: file\n                })\n            },\n        },\n        call: {\n            get: function(origin, link) {\n                return $http({\n                    method: 'GET',\n                    url: '/api/calls/get',\n                    params: {\n                        link: link,\n                        // origin: origin\n                    }\n                })\n            },\n            save: function(params) {\n                return $http.post('/api/calls', params);\n            },\n        },\n        sms: {\n            get: function(origin, link) {\n                return $http({\n                    method: 'GET',\n                    url: '/api/sms/get',\n                    params: {\n                        link: link,\n                        origin: origin\n                    }\n                })\n            },\n            save: function(params) {\n                return $http.post(\"/api/sms\", params)\n            },\n\n        },\n        getDistance: function(options) {\n            return $http({\n                method: 'GET',\n                cache: true,\n                url: '/api/mapGetDistance',\n                params: options\n            }).success(function(result) {\n                return result;\n            });\n        },\n        request: function(options) {\n            return $http({\n                method: options.method || 'GET',\n                url: '/api/' + options.fn,\n                params: options.data\n            });\n        },\n\n        getUser: function() {\n            return $http({\n                method: 'GET',\n                cache: true,\n                url: \"/api/whoAmI\"\n            });\n        },\n    }\n}]);\n","/*angular.module('edison').factory('config', [function() {\n    \"use strict\";\n    console.log(window.config)\n    var config = {};\n\n    config.civilites = [{\n        short_name: 'M.',\n        long_name: 'Monsieur'\n    }, {\n        short_name: 'Mme.',\n        long_name: 'Madame'\n    }, {\n        short_name: 'Soc.',\n        long_name: 'Société'\n    }];\n\n    config.civilitesTab = ['M.', 'Mme.', 'Soc.'];\n\n    config.categoriesKV = {\n        EL: {\n            s: 'EL',\n            o: 2,\n            n: 'Electricité',\n            c: 'yellow  accent-4 black-text'\n        },\n        PL: {\n            s: 'PL',\n            o: 0,\n            n: 'Plomberie',\n            c: 'blue white-text'\n        },\n        CH: {\n            s: 'CH',\n            o: 1,\n            n: 'Chauffage',\n            c: 'red white-text'\n        },\n        CL: {\n            s: 'CL',\n            o: 6,\n            n: 'Climatisation',\n            c: 'teal white-text'\n        },\n        SR: {\n            s: 'SR',\n            o: 3,\n            n: 'Serrurerie',\n            c: 'brown white-text'\n        },\n        VT: {\n            s: 'VT',\n            o: 4,\n            n: 'Vitrerie',\n            c: 'green white-text'\n        },\n        AS: {\n            s: 'AS',\n            o: 5,\n            n: 'Assainissement',\n            c: 'orange white-text'\n        },\n        PT: {\n            s: 'PT',\n            o: 7,\n            n: 'Peinture',\n            c: 'deep-orange white-text'\n        }\n    }\n    config.categoriesAKV = [{\n        s: 'PL',\n        o: 0,\n        n: 'Plomberie',\n        c: 'blue white-text'\n    }, {\n        s: 'CH',\n        o: 1,\n        n: 'Chauffage',\n        c: 'red white-text'\n    }, {\n        s: 'EL',\n        o: 2,\n        n: 'Electricité',\n        c: 'yellow  accent-4 black-text'\n    }, {\n        s: 'SR',\n        o: 3,\n        n: 'Serrurerie',\n        c: 'brown white-text'\n    }, {\n        s: 'VT',\n        o: 4,\n        n: 'Vitrerie',\n        c: 'green white-text'\n    }, {\n        s: 'AS',\n        o: 5,\n        n: 'Assainissement',\n        c: 'orange white-text'\n    }, {\n        s: 'CL',\n        o: 6,\n        n: 'Climatisation',\n        c: 'teal white-text'\n    }, {\n        s: 'PT',\n        o: 7,\n        n: 'Peinture',\n        c: 'deep-orange white-text'\n    }]\n    config.fournisseur = [{\n        short_name: 'ARTISAN',\n        type: 'Fourniture Artisan'\n    }, {\n        short_name: 'CEDEO',\n        type: 'Fourniture Edison'\n    }, {\n        short_name: 'BROSSETTE',\n        type: 'Fourniture Edison'\n    }, {\n        short_name: 'REXEL',\n        type: 'Fourniture Edison'\n    }, {\n        short_name: 'COAXEL',\n        type: 'Fourniture Edison'\n    }, {\n        short_name: 'YESSS ELECTRIQUE',\n        type: 'Fourniture Edison'\n    }, {\n        short_name: 'CGED',\n        type: 'Fourniture Edison'\n    }, {\n        short_name: 'COSTA',\n        type: 'Fourniture Edison'\n    }, {\n        short_name: 'FORUM DU BATIMENT',\n        type: 'Fourniture Edison'\n    }]\n\n\n    config.modeDeReglements = [{\n        short_name: 'CB',\n        long_name: 'Carte Bancaire'\n    }, {\n        short_name: 'CH',\n        long_name: 'Chèque'\n    }, {\n        short_name: 'CA',\n        long_name: 'Espèces'\n    }];\n\n    config.tva = [{\n        short_name: 10,\n        long_name: \"TVA: 10%\"\n    }, {\n        short_name: 20,\n        long_name: \"TVA: 20%\"\n    }];\n    config.typePayeur = [{\n        short_name: 'SOC',\n        long_name: 'Société'\n    }, {\n        short_name: 'PRO',\n        long_name: 'Propriétaire'\n    }, {\n        short_name: 'LOC',\n        long_name: 'Locataire'\n    }, {\n        short_name: 'IMO',\n        long_name: 'Agence Immobilière'\n    }, {\n        short_name: 'CUR',\n        long_name: 'Curatelle'\n    }, {\n        short_name: 'AUT',\n        long_name: 'Autre'\n    }];\n\n    config.etatsKV = {\n        ENV: {\n            n: 'Envoyé',\n            c: 'orange'\n        },\n        RGL: {\n            n: 'Reglé',\n            c: 'green'\n        },\n        PAY: {\n            n: 'Payé',\n            c: 'green accent-4'\n        },\n        ATT: {\n            n: 'Reglement En Attente',\n            c: 'purple'\n        },\n        ATTC: {\n            n: 'RC En Attente',\n            c: 'purple'\n        },\n        ATTS: {\n            n: 'RS En Attente',\n            c: 'pink darken-4'\n        },\n        APR: {\n            n: 'A Progr.',\n            c: 'blue'\n        },\n        AVR: {\n            n: 'A Vérifier',\n            c: 'brown darken-3'\n        },\n        ANN: {\n            n: 'Annuler',\n            c: 'red'\n        },\n        DEV: {\n            n: 'Devis',\n            c: 'light-blue'\n        },\n    }\n\n    config.status = function(inter) {\n        return {\n            intervention: config.etatsKV[inter.status]\n        }\n    }\n    return config;\n\n}]);\n*/","angular.module('edison').factory('contextMenu', ['$location', 'edisonAPI', 'actionIntervention', '$window', 'dialog', function($location, edisonAPI, actionIntervention, $window, dialog) {\n    \"use strict\";\n    var content = {};\n\n    content.interventionList = [{\n        hidden: false,\n        title: 'Ouvrir Fiche',\n        click: function(inter) {\n            $location.url('/intervention/' + inter.id)\n        }\n    }, {\n        hidden: false,\n        title: \"Appeler l'artisan\",\n        click: function(inter) {\n            if (inter.artisan) {\n                var now = Date.now();\n                $window.open('callto:' + inter.artisan.telephone.tel1, '_self', false)\n                dialog.choiceText({\n                    title: 'Nouvel Appel',\n                }, function(response, text) {\n                    edisonAPI.call.save({\n                        date: now,\n                        to: inter.artisan.telephone.tel1,\n                        link: inter.artisan.id,\n                        origin: inter.id || inter.tmpID,\n                        description: text,\n                        response: response\n                    }).success(function(resp) {\n                        inter.artisan.calls.unshift(resp)\n                    })\n                })\n            }\n        },\n        hide: function(inter) {\n            return !inter.ai\n        }\n    }, {\n        hidden: false,\n        title: \"SMS artisan\",\n        click: function(inter) {\n            dialog.getText({\n                title: \"Texte du SMS\",\n                text: \"\\nEdison Service\"\n            }, function(text) {\n                edisonAPI.sms.send({\n                    link: inter.artisan.id,\n                    origin: inter.id,\n                    text: text,\n                    to: \"0633138868\"\n                })\n            })\n        },\n        hide: function(inter) {\n            return !inter.ai\n        }\n    }, {\n        hidden: false,\n        title: \"Envoyer\",\n        click: actionIntervention.envoi,\n        hide: function(inter) {\n            return inter.s !== \"APR\" && inter.s !== 'ANN'\n        }\n    }, {\n        hidden: false,\n        title: \"Vérifier\",\n        click: actionIntervention.verification,\n        hide: function(inter) {\n            return inter.s !== \"AVR\" && inter.s !== 'ENV'\n        }\n    }, {\n        hidden: false,\n        title: \"Annuler\",\n        click: actionIntervention.annulation\n\n    }]\n\n    var ContextMenu = function(page) {\n        this.content = content[page];\n    }\n\n    ContextMenu.prototype.setData = function(data) {\n        this.data = data;\n    }\n\n    ContextMenu.prototype.setPosition = function(x, y) {\n        this.style.left = (x - $('#main-menu-inner').width());\n        this.style.top = y;\n    }\n\n    ContextMenu.prototype.active = false;\n\n    ContextMenu.prototype.open = function() {\n        var _this = this;\n        this.content.forEach(function(e) {\n            e.hidden = e.hide && e.hide(_this.data);\n        })\n        this.style.display = \"block\";\n        this.active = true;\n    }\n\n    ContextMenu.prototype.close = function() {\n        this.style.display = \"none\";\n        this.active = false;\n\n    }\n\n    ContextMenu.prototype.style = {\n        left: 0,\n        top: 0,\n        display: \"none\"\n    }\n\n    return function(page) {\n        return new ContextMenu(page);\n    }\n\n}]);\n","angular.module('edison').factory('dataProvider', ['socket', '$rootScope', 'config', function(socket, $rootScope, config) {\n    \"use strict\";\n    var dataProvider = function() {\n        var _this = this;\n        socket.on('interventionListChange', function(data) {\n            _this.updateInterventionList(data);\n        });\n    }\n    dataProvider.prototype.setInterventionList = function(data) {\n        this.interventionList = data;\n    };\n\n    dataProvider.prototype.refreshInterventionListFilter = function(params, hash) {\n        console.time(\"interFilter\")\n        console.log(params)\n        this.interventionListFiltered = this.interventionList;\n        if (this.interventionList && params) {\n            var filterParam = config.filters().get(params.fltr);\n            if (params.fltr && filterParam || !params.fltr && hash) {\n                this.interventionListFiltered = _.filter(this.interventionList, function(e) {\n                    return (!params.fltr || e.fltr[filterParam.short_name]) &&\n                    (!hash || e.t === hash) &&\n                    ((!params.d) || (e.fltr.d && e.fltr.d[params.d]))\n                })\n            } else if (params.artisanID) {\n                var artisanID = parseInt(params.artisanID);\n                this.interventionListFiltered = _.filter(this.interventionList, function(e) {\n                    return e.ai === artisanID;\n                })\n            }\n        }\n        console.timeEnd(\"interFilter\")\n\n    }\n\n    dataProvider.prototype.updateInterventionList = function(data) {\n        var _this = this;\n        if (this.interventionList) {\n            var index = _.findIndex(this.interventionList, function(e) {\n                return e.id === data.id\n            });\n            _this.interventionList[index] = data;\n            $rootScope.$broadcast('InterventionListChange');\n        }\n    }\n\n    dataProvider.prototype.getInterventionList = function() {\n        return this.interventionList;\n    }\n\n    return new dataProvider();\n\n}]);\n","angular.module('edison').factory('dialog', ['$mdDialog', 'edisonAPI', function($mdDialog, edisonAPI) {\n    \"use strict\";\n\n    return {\n        envoiFacture: function(inter, cb) {\n            $mdDialog.show({\n                controller: function DialogController($scope, $mdDialog) {\n                    var template = \"{{client.civilite}} {{client.nom}}, \\n\" +\n                        \"Vous trouverez ci-joint la facture de notre intervention\\n\" +\n                        \"Cordialement\\n\" +\n                        \"Edison Services\"\n                    $scope.text = _.template(template)(inter);\n                    $scope.date = new Date();\n                    $scope.acquitte = false;\n                    $scope.answer = function(cancel) {\n                        $mdDialog.hide();\n                        if (!cancel) {\n                            cb($scope.text, $scope.acquitte, $scope.date);\n                        }\n                    }\n                },\n                templateUrl: '/DialogTemplates/envoiFacture.html',\n            });\n        },\n        recap: function(inters) {\n            $mdDialog.show({\n                controller: function DialogController($scope, $mdDialog) {\n                    $scope.inters = inters;\n                    $scope.answer = function() {\n                        $mdDialog.hide();\n                    }\n                },\n                templateUrl: '/DialogTemplates/recapList.html',\n            });\n        },\n        callsList: function(sst) {\n            $mdDialog.show({\n                controller: function DialogController($scope, $mdDialog) {\n                    $scope.sst = sst;\n                    $scope.answer = function() {\n                        $mdDialog.hide();\n                    }\n                },\n                templateUrl: '/DialogTemplates/callsList.html',\n            });\n        },\n        smsList: function(sst) {\n            $mdDialog.show({\n                controller: function DialogController($scope, $mdDialog) {\n                    $scope.sst = sst;\n                    $scope.answer = function() {\n                        $mdDialog.hide();\n                    }\n                },\n                templateUrl: '/DialogTemplates/smsList.html',\n            });\n        },\n        choiceText: function(options, cb) {\n            $mdDialog.show({\n                controller: function DialogController($scope, $mdDialog) {\n                    $scope.options = options;\n                    $scope.answer = function(resp, text) {\n                        $mdDialog.hide();\n                        return cb(resp, text);\n                    }\n                },\n                templateUrl: '/DialogTemplates/choiceText.html',\n            });\n        },\n        getText: function(options, cb) {\n            $mdDialog.show({\n                controller: function DialogController($scope, $mdDialog) {\n                    $scope.options = options;\n                    $scope.answer = function() {\n                        $mdDialog.hide();\n                        return cb($scope.options.text);\n                    }\n                },\n                templateUrl: '/DialogTemplates/text.html',\n            });\n        },\n        getFileAndText: function(data, files, cb) {\n            $mdDialog.show({\n                controller: function DialogController($scope, $mdDialog) {\n\n                    var getSMS = function() {\n                        var sms = data.id ? \"OS \" + data.id + \". \\n\" : \"\";\n                        sms += \"Intervention chez \" + data.client.civilite + \" \" +\n                            data.client.prenom + \" \" + data.client.nom + \" au \" +\n                            data.client.address.n + \" \" + data.client.address.r + \" \" +\n                            data.client.address.cp + \", \" + data.client.address.v + \" le \" +\n                            moment(data.date.intervention).format(\"LLLL\") + \". \\n\";\n                        sms += data.prixAnnonce ? data.prixAnnonce + \"€ HT. \" : \"Pas de prix annoncé. \";\n                        sms += \"\\nMerci de prendre rdv avec le client au \" + data.client.telephone.tel1;\n                        sms += data.client.telephone.tel2 ? \"ou au \" + data.client.telephone.tel2 : \"\"\n                        return sms + \".\\nEdison Services.\"\n                    }\n                    $scope.xfiles = files\n                    $scope.smsText = getSMS();\n                    $scope.answer = function(cancel) {\n                        $mdDialog.hide();\n                        if (cancel === false) {\n                            return cb($scope.smsText, $scope.addedFile);\n                        }\n                    }\n                },\n                templateUrl: '/DialogTemplates/fileAndText.html',\n            });\n        },\n        editProduct: {\n            open: function(produit, cb) {\n                $mdDialog.show({\n                    controller: function DialogController($scope, $mdDialog) {\n                        $scope.produit = _.clone(produit);\n                        $scope.mdDialog = $mdDialog;\n                        $scope.answer = function(p) {\n                            $mdDialog.hide(p);\n                            return cb(p);\n                        }\n                    },\n                    templateUrl: '/DialogTemplates/edit.html',\n                });\n            }\n        },\n        absence: {\n            open: function(id, cb) {\n                $mdDialog.show({\n                    controller: function DialogController($scope, $mdDialog) {\n                        $scope.absenceTime = 'TODAY';\n                        $scope.absence = [{\n                            title: 'Toute la journée',\n                            value: 'TODAY'\n                        }, {\n                            title: '1 Heure',\n                            value: '1'\n                        }, {\n                            title: '2 Heure',\n                            value: '2'\n                        }, {\n                            title: '3 Heure',\n                            value: '3'\n                        }, {\n                            title: '4 Heure',\n                            value: '4'\n                        }]\n                        $scope.hide = function() {\n                            $mdDialog.hide();\n                        };\n                        $scope.cancel = function() {\n                            $mdDialog.cancel();\n                        };\n                        $scope.answer = function(answer) {\n                            $mdDialog.hide(answer);\n                            var hours = 0;\n                            if (answer === \"TODAY\") {\n                                hours = 23 - (new Date()).getHours() + 1;\n                            } else {\n                                hours = parseInt(answer);\n                            }\n                            var start = new Date();\n                            var end = new Date();\n                            end.setHours(end.getHours() + hours)\n                            edisonAPI.artisan.setAbsence(id, {\n                                start: start,\n                                end: end\n                            }).success(cb)\n                        };\n                    },\n                    templateUrl: '/DialogTemplates/absence.html',\n                });\n            }\n        }\n    }\n\n}]);\n","angular.module('edison').factory('fourniture', [function() {    \n    \"use strict\";\n    return {\n        init: function(fourniture) {\n            this.fourniture = fourniture;\n            if (!this.fourniture)\n                this.fourniture = [];\n            return this;\n        },\n        remove: function(index) {\n            this.fourniture.splice(index, 1);\n        },\n        moveTop: function(index) {\n            if (index !== 0) {\n                var tmp = this.fourniture[index - 1];\n                this.fourniture[index - 1] = this.fourniture[index];\n                this.fourniture[index] = tmp;\n            }\n\n        },\n        moveDown: function(index) {\n            if (index !== this.fourniture.length - 1) {\n                var tmp = this.fourniture[index + 1];\n                this.fourniture[index + 1] = this.fourniture[index];\n                this.fourniture[index] = tmp;\n            }\n        },\n        add: function() {\n            console.log('add')\n            this.fourniture.push({\n                title: 'Fourniture',\n                fournisseur: 'ARTISAN',\n                quantite: 1,\n                pu: 0\n            });\n        },\n        total: function() {\n            var total = 0;\n            if (this.fourniture) {\n                this.fourniture.forEach(function(e) {\n                    total += (e.pu * e.quantite);\n                })\n            }\n            return total\n        }\n    }\n\n}]);\n","","angular.module('edison').factory('Map', function() {\n    \"use strict\";\n\n    var Map = function() {\n        this.display = false;\n    }\n\n    Map.prototype.setCenter = function(address) {\n        this.center = address;\n    }\n\n    Map.prototype.setZoom = function(value) {\n        this.zoom = value\n    }\n    Map.prototype.show = function() {\n        this.display = true;\n    }\n    return Map;\n});\n","angular.module('edison').factory('mapAutocomplete', ['$q', 'Address',\n    function($q, Address) {\n        \"use strict\";\n        var autocomplete = function() {\n            this.service = new google.maps.places.AutocompleteService();\n            this.geocoder = new google.maps.Geocoder();\n        }\n\n        autocomplete.prototype.search = function(input) {\n            var deferred = $q.defer();\n            this.service.getPlacePredictions({\n                input: input,\n                componentRestrictions: {\n                    country: 'fr'\n                }\n            }, function(predictions) {\n                if (predictions)\n                    predictions.forEach(function(e) {\n                        if (e.description === input)\n                            predictions = null;\n                    })\n                deferred.resolve(predictions || []);\n            });\n            return deferred.promise;\n        }\n\n        autocomplete.prototype.getPlaceAddress = function(place) {\n            var self = this;\n            return $q(function(resolve, reject) {\n                self.geocoder.geocode({\n                    'address': place.description\n                }, function(result, status) {\n                    if (status !== google.maps.places.PlacesServiceStatus.OK)\n                        return reject(status);\n                    return resolve(Address(result[0]));\n                });\n\n            });\n        };\n\n        return new autocomplete();\n\n    }\n]);\n","angular.module('edison').factory('openPost', [function() {\n    \"use strict\";\n    return function(url, data) {\n        var mapForm = document.createElement(\"form\");\n        mapForm.target = \"_blank\";\n        mapForm.method = \"POST\";\n        mapForm.action = url;\n\n        // Create an input\n        _.each(data, function(e, i) {\n                var mapInput = document.createElement(\"input\");\n                mapInput.type = \"text\";\n                mapInput.name = i;\n                mapInput.value = e;\n                mapForm.appendChild(mapInput);\n            })\n            // Add the form to dom\n        document.body.appendChild(mapForm);\n\n        // Just submit\n        mapForm.submit();\n    }\n}]);\n","angular.module('edison').factory('productsList', ['dialog', 'openPost', function(dialog, openPost) {\n    \"use strict\";\n    var ps = [{\n        quantite: 1,\n        ref: \"EDI001\",\n        title: \"Main d'œuvre\",\n        desc: \"Main d'œuvre\",\n        pu: 65\n    }, {\n        quantite: 1,\n        ref: \"EDI002\",\n        title: \"Déplacement\",\n        desc: \"Déplacement\",\n        pu: 65\n    }, {\n        quantite: 1,\n        ref: \"EDI005\",\n        title: \"Forfait Intervention\",\n        desc: \"Forfait INSTALLATION / MAIN D\\'OUVRAGEEssais et mise en service inclus\",\n        pu: 130\n    }, {\n        quantite: 1,\n        ref: \"FRN001\",\n        title: \"Fourniture\",\n        desc: \"\",\n        pu: 0\n    }, {\n        quantite: 1,\n        ref: \"BAL001\",\n        title: \"ballon mural vertical\",\n        desc: \"Chauffe-eau électrique mural vertical\\nRésistance blindée anti-calcaire\\nPuissance : 1800 W\\nType de courant : monophasé\\nV = 200L\\n\\nRACCORDEMENT ÉLECTRIQUE MONO 220V (HEURE CREUSE / PLEINE)\\n\\nMARQUE ATLANTIC CERTIFIE\\n\\nGarantie constructeur : Jusqu'à 5 ans\\nGarante pièce d'origine : Jusqu'à 2 ans\\n\\nAssistance et dépannage constructeur inclus jusqu'à 2 ans\\n\\nESSAIS ET MISE EN SERVICE INCLUS\",\n        pu: 432.1\n\n    }, {\n        quantite: 1,\n        ref: \"BAL002\",\n        title: \"groupe de securité\",\n        desc: \"Groupe de sécurité anti-calcaire 3/4.Robinet à sphère.\\nClapet démontable\\nRaccordement eau froide et chauffe eau : 20/27.Echappement 26/34.7 bars.\\nEntonnoir siphon\",\n        pu: 69.97\n    }, {\n        quantite: 1,\n        ref: \"BAL003\",\n        title: \"Raccordement hydraulique\",\n        desc: \"Raccordement hydraulique\\nFlexibles inox de 50 cm F20/27 ø 16 mm\",\n        pu: 16.33\n    }, {\n        quantite: 1,\n        ref: \"BAL004\",\n        title: \"Trépied Ballon\",\n        desc: \"Trépied pour chauffe-eau électrique.\\nAccessoire obligatoire pour l'installation d'un chauffe-eau électrique de 100, 150, ou 200 litres sur un mur non porteur\",\n        pu: 93.21\n    }, {\n        quantite: 1,\n        ref: 'VIT001',\n        title: \"Remplacement Vitrage\",\n        desc: \"Remplacement d'un vitrage suite a un bris de glace \\nporte fenêtre\\ndouble vitrage\\nvitrage clair\\n2000 x 1000\\nchâssis pvc / alu / bois\\n\\ncommande spéciale sur mesure\\nadaptation et fixation sur place\\n\\nremplacement a l'identique\",\n        pu: 297.13\n    }, {\n        quantite: 1,\n        ref: \"VIT002\",\n        title: \"Pack Vitrerie\",\n        desc: \"depose/livraison + mise a la decharge + taxe energie\",\n        pu: 75\n    }, {\n        quantite: 1,\n        ref: \"SANI001\",\n        title: \"Pack Sanibroyeur\",\n        desc: \"PACK COMPLET SANIBROYEUR PRO\\nRefoulement horizontal < 100m\\nRefoulement vertical > 5m\\nRégime moteur > 2800 tr/min\\nNorme européenne \\nEN 12050-3\\nRaccordement hydraulique\\nRaccordement électrique\\nGarantie constructeur\",\n        pu: 672.21\n    }, {\n        quantite: 1,\n        ref: \"CAM001\",\n        title: \"Camion D'assainisement\",\n        desc: \"DÉGORGEMENT CANALISATION TRÈS HAUTE PRESSION PAR CAMION D’ASSAINISSEMENT : \\nCurage et nettoyage complet de la canalisation jusqu\\'à 10M\",\n        pu: 696.25\n    }, {\n        quantite: 1,\n        ref: \"AUT001\",\n        title: \"Autre\",\n        desc: \"\",\n        pu: 0\n    }];\n\n    var Produit = function(produits) {\n        this.produits = produits;\n    }\n    Produit.prototype = {\n        remove: function(index) {\n            this.produits.splice(index, 1);\n        },\n        moveTop: function(index) {\n            if (index !== 0) {\n                var tmp = this.produits[index - 1];\n                this.produits[index - 1] = this.produits[index];\n                this.produits[index] = tmp;\n            }\n\n        },\n        moveDown: function(index) {\n            if (index !== this.produits.length - 1) {\n                var tmp = this.produits[index + 1];\n                this.produits[index + 1] = this.produits[index];\n                this.produits[index] = tmp;\n            }\n        },\n        edit: function(index) {\n            var _this = this;\n            dialog.editProduct.open(this.produits[index], function(res) {\n                _this.produits[index] = res;\n            })\n        },\n        add: function(prod) {\n            this.searchText = '';\n            this.produits.push(prod);\n        },\n        search: function(text) {\n            var rtn = []\n            for (var i = 0; i < ps.length; ++i) {\n                if (text === ps[i].title)\n                    return [];\n                var needle = _.deburr(text).toLowerCase()\n                var haystack = _.deburr(ps[i].title).toLowerCase();\n                if (haystack.indexOf(needle) >= 0) {\n                    rtn.push(_.clone(ps[i]))\n                }\n            }\n            return rtn\n        },\n        total: function() {\n            var total = 0;\n            if (this.produits) {\n                this.produits.forEach(function(e) {\n                    total += (e.pu * e.quantite);\n                })\n            }\n            return total\n        },\n        previsualise: function(data) {\n            openPost('/api/intervention/facturePreview', {\n                data:JSON.stringify(data),\n                html:true\n            })\n        }\n    }\n\n    return Produit;\n\n\n}]);\n","angular.module('edison').factory('socket', function(socketFactory) {\n    \"use strict\";\n    return socketFactory();\n});\n","angular.module('edison').factory('tabContainer', ['$location', '$window', '$q', 'edisonAPI', function($location, $window, $q, edisonAPI) {\n    \"use strict\";\n    var Tab = function(args) {\n\n        if (typeof args === 'object') {\n            //copy constructor\n            _.each(args, function(e, k) {\n                this[k] = e;\n            })\n        } else {\n            this.url = args;\n            this.title = '';\n            this.position = null;\n            this.deleted = false;\n            this._timestamp = Date.now();\n        }\n    }\n\n    Tab.prototype.setData = function(data) {\n        //slice create a copy\n        this._data = JSON.parse(JSON.stringify(data));\n        this.data = JSON.parse(JSON.stringify(data));\n    }\n\n    Tab.prototype.setTitle = function(title, subTitle) {\n        this.title = title;\n        this.subTitle = subTitle\n    }\n\n    var TabContainer = function() {\n        this._tabs = [];\n        this.selectedTab = 0;\n    }\n\n    TabContainer.prototype.loadSessionTabs = function(currentUrl) {\n        var _this = this;\n\n        return $q(function(resolve, reject) {\n            var currentUrlInSessionTabs = false;\n            edisonAPI.request({\n                fn: \"getSessionData\",\n            }).then(function(result) {\n                _this.selectedTab = result.data.selectedTab;\n                for (var i = 0; i < result.data._tabs.length; i++) {\n                    _this._tabs.push(new Tab(result.data._tabs[i]))\n                    if (result.data._tabs[i].url === currentUrl) {\n                        _this.selectedTab = i;\n                        currentUrlInSessionTabs = true;\n                    }\n                }\n                if (!currentUrlInSessionTabs) {\n                    return reject();\n                }\n                return resolve();\n            }).catch(reject);\n\n        })\n\n    }\n\n    TabContainer.prototype.setFocus = function(tab) {\n        this.selectedTab = (typeof tab === 'number' ? tab : tab.position);\n    };\n\n    TabContainer.prototype.createTab = function(url) {\n        var tab = new Tab(url);\n\n        tab.position = this._tabs.length;\n        this._tabs.push(tab);\n        return (tab);\n    }\n\n    TabContainer.prototype.isOpen = function(url) {\n        var index = _.findIndex(this._tabs, function(e) {\n            return ((!e.deleted && e.url === url));\n        });\n        return (index >= 0);\n    };\n\n    TabContainer.prototype.getTab = function(url) {\n\n        return _.find(this._tabs, function(e) {\n            return ((!e.deleted && e.url === url));\n        });\n    };\n\n    TabContainer.prototype.len = function() {\n        var size = 0;\n\n        this._tabs.forEach(function(e) {\n            size += !e.deleted;\n        })\n        return (size);\n    }\n\n    TabContainer.prototype.getPrevTab = function(tab) {\n\n        for (var i = tab.position - 1; i >= 0; i--) {\n            if (this._tabs[i].deleted === false)\n                return (this._tabs[i]);\n        }\n\n    };\n\n    TabContainer.prototype.remove = function(tab) {\n        var newTabs = [];\n        var j = 0;\n\n        if (this._tabs.length <= 1) {\n            return false;\n        }\n        var reload = (this.selectedTab === tab.position);\n        for (var i = 0; i < this._tabs.length; i++) {\n            if (i !== tab.position) {\n                newTabs.push(this._tabs[i]);\n                newTabs[j].position = j;\n                ++j;\n            }\n        }\n        this._tabs = newTabs;\n\n        if (this.selectedTab === tab.position && this.selectedTab !== 0) {\n            this.selectedTab--;\n        }\n        if (this.selectedTab > tab.position) {\n            this.selectedTab--;\n        }\n        return (reload);\n    }\n\n    TabContainer.prototype.getCurrentTab = function() {\n        return this._tabs[this.selectedTab];\n    }\n    TabContainer.prototype.addTab = function(url, options) {\n        var tab;\n        if (!this.isOpen(url)) {\n            tab = this.createTab(url);\n        } else {\n            tab = this.getTab(url)\n        }\n        if (!(options && options.setFocus === false)) {\n            this.setFocus(tab)\n        }\n        if (options && options.title) {\n            tab.setTitle(options.title);\n        }\n    }\n\n    return (new TabContainer());\n\n}]);\n","angular.module('edison').factory('taskList', ['dialog', 'edisonAPI', function(dialog, edisonAPI) {\n    \"use strict\";\n    var Task = function(user) {\n        edisonAPI.get({\n            to: user,\n            done: false\n        })\n    }\n    Task.prototype = {\n        check: function(_id) {\n            edisonAPI.check({\n                _id: _id\n            })\n        },\n        add: function(params) {\n            edisonAPI.add(params)\n\n        }\n    }\n    return Task;\n\n\n}]);\n","","angular.module('edison').controller('ArtisanController', function(tabContainer, $location, $mdSidenav, $interval, ngDialog, LxNotificationService, edisonAPI, config, $routeParams, $scope, artisan) {\n  \"use strict\";\n  $scope.config = config;\n  $scope.tab = tabContainer.getCurrentTab();\n\n  if (!$scope.tab.data) {\n    if ($routeParams.id.length > 12) {\n      $scope.tab.isNew = true;\n      $scope.tab.setTitle('@' + moment().format(\"HH:mm\").toString());\n    } else {\n      $scope.tab.setTitle('@' + $routeParams.id);\n      if (!artisan) {\n        alert(\"Impossible de trouver les informations !\");\n        $location.url(\"/dashboard\");\n        $scope.tabs.remove($scope.tab);\n        return 0;\n      }\n    }\n    $scope.tab.setData(artisan.data);\n  }\n});\n","angular.module('edison').controller('DashboardController', function(tabContainer, $scope) {\n    \"use strict\";\n    $scope.tab = tabContainer.getCurrentTab();\n    $scope.tab.setTitle('dashBoard')\n});\n","var InterventionCtrl = function($rootScope, $window, $scope, $location, $routeParams, dialog, fourniture, LxNotificationService, tabContainer, edisonAPI, Address, $q, mapAutocomplete, productsList, config, intervention, artisans, actionIntervention, Map) {\n    \"use strict\";\n\n    var _this = this;\n    _this.artisans = artisans.data;\n    _this.config = config;\n    _this.dialog = dialog;\n    _this.autocomplete = mapAutocomplete;\n    var tab = tabContainer.getCurrentTab();\n    if (!tab.data) {\n        tab.setData(intervention.data);\n        tab.data.sst = intervention.data.artisan ? intervention.data.artisan.id : 0;\n\n        if ($routeParams.id.length > 12) {\n            _this.isNew = true;\n            tab.data.tmpID = $routeParams.id;\n            tab.setTitle('#' + moment((new Date(parseInt(tab.data.tmpID))).toISOString()).format(\"HH:mm\").toString());\n        } else {\n            tab.setTitle('#' + $routeParams.id);\n            if (!intervention) {\n                alert(\"Impossible de trouver les informations !\");\n                $location.url(\"/dashboard\");\n                tabContainer.remove(tab);\n                return 0;\n            }\n        }\n    }\n\n    _this.data = tab.data;\n    if (!_this.data.id)\n        _this.data.login = {\n            ajout: $rootScope.user.login\n        }\n\n    _this.data.produits = _this.data.produits || [];\n    $scope.produits = new productsList(_this.data.produits);\n\n    _this.data.fourniture = _this.data.fourniture || [];\n    $scope.fourniture = fourniture.init(_this.data.fourniture);\n\n    _this.changeAddressFacture = function(place) {\n        mapAutocomplete.getPlaceAddress(place).then(function(addr) {\n            _this.data.facture.address = addr;\n        });\n    }\n    $scope.envoiSAV = function(sav) {\n        sav.status = \"ENV\"\n    }\n    $scope.changeArtisan = function(sav) {\n        sav.artisan = _.find(_this.artisans, function(e) {\n            return e.id === sav.sst;\n        })\n    }\n\n    $scope.addSAV = function() {\n        dialog.getText({\n            title: \"Description du SAV\",\n            text: \"\"\n        }, function(resp) {\n            if (!_this.data.sav)\n                _this.data.sav = [];\n            _this.data.sav.push({\n                date: new Date(),\n                login: $rootScope.user.login,\n                description: resp,\n                regle: false\n            })\n            console.log(_this.data.sav);\n        })\n    }\n\n    $scope.envoiFacture = function() {\n        actionIntervention.envoiFacture(_this.data, function(err, res) {\n            if (!err)\n                _this.data.date.envoiFacture = new Date();\n            console.log(res);\n        })\n    }\n\n\n    $scope.envoiDevis = function() {\n        actionIntervention.envoiDevis(_this.data, function(err, res) {\n            if (!err)\n                _this.data.date.envoiFacture = new Date();\n            console.log(res);\n        })\n    }\n    $scope.recapArtisan = function(sst) {\n        edisonAPI.artisan.lastInters(sst.id)\n            .success(dialog.recap);\n    }\n\n    $scope.smsArtisan = function() {\n        actionIntervention.smsArtisan(_this.data, function(err, resp) {\n            if (!err)\n                _this.data.artisan.calls.unshift(resp)\n        })\n    }\n\n    $scope.callArtisan = function() {\n        actionIntervention.callArtisan(_this.data, function(err, resp) {\n            if (!err)\n                _this.data.artisan.calls.unshift(resp)\n        })\n    }\n\n\n    $scope.addProductSupp = function(prod) {\n        $scope.produitsSupp.add(prod);\n        $scope.searchProd = \"\";\n    }\n\n\n    $scope.addProduct = function(prod) {\n        $scope.produits.add(prod);\n        $scope.searchProd = \"\";\n    }\n\n    $scope.clickTrigger = function(elem) {\n        angular.element(elem).trigger('click');\n    }\n\n    $scope.addComment = function() {\n        _this.data.comments.push({\n            login: $rootScope.user.login,\n            text: $scope.commentText,\n            date: new Date()\n        })\n        $scope.commentText = \"\";\n    }\n\n    $scope.changeCategorie = function(key) {\n        _this.data.categorie = key;\n        if (_this.data.client.address)\n            _this.searchArtisans();\n    }\n\n    $scope.onFileUpload = function(file) {\n        if (file) {\n            edisonAPI.file.upload(file, {\n                link: _this.data.id || _this.data.tmpID,\n                model: 'intervention',\n                type: 'fiche'\n            }).success(function() {\n                $scope.fileUploadText = \"\";\n                $scope.loadFilesList();\n            })\n        }\n    }\n\n\n    $scope.loadFilesList = function() {\n        edisonAPI.intervention.getFiles(_this.data.id || _this.data.tmpID).then(function(result) {\n            _this.data.files = result.data;\n        }, console.log)\n    }\n    $scope.loadFilesList();\n\n\n    var closeTab = function() {\n        $location.url(\"/interventions\");\n        tabContainer.remove(tab)\n    }\n\n    $scope.saveInter = function(options) {\n        actionIntervention.save(_this.data, function(err, resp) {\n            if (err) {\n                return false;\n            } else if (options && options.envoi === true) {\n                actionIntervention.envoi(resp, closeTab);\n            } else if (options && options.annulation) {\n                actionIntervention.annulation(resp, closeTab);\n            } else if (options && options.verification) {\n                actionIntervention.verification(resp, closeTab);\n            } else {\n                closeTab();\n            }\n        })\n\n    }\n\n    $scope.clickOnArtisanMarker = function(event, sst) {\n        _this.data.sst = sst.id;\n    }\n\n    _this.searchArtisans = function() {\n        edisonAPI.artisan.getNearest(_this.data.client.address, _this.data.categorie)\n            .success(function(result) {\n                _this.nearestArtisans = result;\n            });\n    }\n    if (_this.data.client.address)\n        _this.searchArtisans();\n\n\n    /*MAP CONTROLLER*/\n    _this.map = new Map();\n    _this.map.setZoom(_this.data.client.address ? 12 : 6)\n    if (_this.isNew) {\n        _this.map.show();\n    }\n    _this.autocomplete = mapAutocomplete;\n\n    if (_this.data.client.address) {\n        _this.data.client.address = Address(_this.data.client.address, true); //true -> copyContructor\n        _this.map.setCenter(_this.data.client.address);\n    } else {\n        _this.map.setCenter(Address({\n            lat: 46.3333,\n            lng: 2.6\n        }));\n    }\n\n    _this.showInterMarker = function() {\n        return _this.data.client.address && _this.data.client.address.latLng;\n    }\n\n    _this.changeAddress = function(place) {\n        mapAutocomplete.getPlaceAddress(place).then(function(addr) {\n            _this.map.zoom = 12;\n            _this.map.center = addr;\n            _this.data.client.address = addr;\n            _this.searchArtisans();\n        });\n    }\n\n\n    $scope.$watch(function() {\n        return _this.data.sst;\n    }, function(id_sst) {\n        if (id_sst) {\n            $q.all([\n                edisonAPI.artisan.get(id_sst, {\n                    cache: true\n                }),\n                edisonAPI.artisan.getStats(id_sst, {\n                    cache: true\n                }),\n                edisonAPI.call.get(_this.data.id || _this.data.tmpID, id_sst),\n                edisonAPI.sms.get(_this.data.id || _this.data.tmpID, id_sst)\n            ]).then(function(result) {\n                _this.data.artisan = result[0].data;\n                _this.data.artisan.stats = result[1].data;\n                _this.data.artisan.calls = result[2].data;\n                _this.data.artisan.sms = result[3].data;\n                if (result[0].data.address) {\n                    edisonAPI.getDistance({\n                            origin: result[0].data.address.lt + \", \" + result[0].data.address.lg,\n                            destination: _this.data.client.address.lt + \", \" + _this.data.client.address.lg\n                        })\n                        .then(function(result) {\n                            _this.data.artisan.stats.direction = result.data;\n                        })\n                }\n            });\n        }\n    })\n\n\n    $scope.sstAbsence = function(id) {\n        if (id) {\n            dialog.absence.open(id, _this.searchArtisans())\n        }\n    }\n\n\n    $scope.getStaticMap = function() {\n        var q = \"?width=\" + Math.round($window.outerWidth * 0.8);\n        if (_this.data.client && _this.data.client.address && _this.data.client.address.latLng)\n            q += (\"&origin=\" + _this.data.client.address.latLng);\n        if (_this.data.artisan && _this.data.artisan.id)\n            q += (\"&destination=\" + _this.data.artisan.address.lt + \",\" + _this.data.artisan.address.lg);\n        return \"/api/mapGetStatic\" + q;\n    }\n\n\n\n\n}\n\nangular.module('edison').controller('InterventionController', InterventionCtrl);\n","angular.module('edison').controller('statsController', function($scope) {\n    \"use strict\";\n    $scope.labels = [\"Download Sales\", \"In-Store Sales\", \"Mail-Order Sales\"];\n    $scope.data = [300, 500, 100];\n});\n","angular.module('edison').controller('InterventionsController', function(tabContainer, $window, contextMenu, edisonAPI, dataProvider, $routeParams, $location, $scope, $q, $rootScope, $filter, config, ngTableParams, interventions, interventionsStats) {\n    \"use strict\";\n    $scope.interventionsStats = interventionsStats.data;\n    $scope.tab = tabContainer.getCurrentTab();\n\n    $scope.recap = $routeParams.artisanID;\n    if ($scope.recap) {\n        $scope.tab.setTitle(\"Recap@\" + $routeParams.artisanID)\n    } else {\n        var title = $routeParams.fltr ? config.filters().get($routeParams.fltr).long_name : 'Interventions';\n        $scope.tab.setTitle(title, $location.hash());\n    }\n    $scope.api = edisonAPI;\n    $scope.config = config;\n    $scope.dataProvider = dataProvider;\n\n    if (!$scope.dataProvider.getInterventionList()) {\n        $scope.dataProvider.setInterventionList(interventions.data);\n    }\n\n    $scope.dataProvider.refreshInterventionListFilter($routeParams, $location.hash());\n\n    var tableParameters = {\n        page: 1, // show first page\n        total: $scope.dataProvider.interventionListFiltered.length,\n        filter: {},\n        count: 100 // count per page\n    };\n    var tableSettings = {\n        //groupBy:$rootScope.config.selectedGrouping,\n        total: $scope.dataProvider.interventionListFiltered,\n        getData: function($defer, params) {\n            var data = $scope.dataProvider.interventionListFiltered;\n            data = $filter('tableFilter')(data, params.filter());\n            params.total(data.length);\n            data = $filter('orderBy')(data, params.orderBy());\n            $defer.resolve(data.slice((params.page() - 1) * params.count(), params.page() * params.count()));\n        },\n        filterDelay: 100\n    }\n    $scope.tableParams = new ngTableParams(tableParameters, tableSettings);\n\n    $rootScope.$on('InterventionListChange', function() {\n        $scope.dataProvider.refreshInterventionListFilter($routeParams, $location.hash());\n        $scope.tableParams.reload();\n    })\n\n    $scope.contextMenu = contextMenu('interventionList')\n\n\n    $scope.getStaticMap = function(inter) {\n        var q = \"?width=500&height=200&precision=0&zoom=11&origin=\" + inter.client.address.lt + \", \" + inter.client.address.lg;\n        return \"/api/mapGetStatic\" + q;\n    }\n    $scope.rowRightClick = function($event, inter) {\n        $scope.contextMenu.setPosition($event.pageX, $event.pageY)\n        $scope.contextMenu.setData(inter);\n        $scope.contextMenu.open();\n        edisonAPI.intervention.get(inter.id, {\n                extend: true\n            })\n            .then(function(resp) {\n                $scope.contextMenu.setData(resp.data);\n            })\n    }\n\n    $scope.rowClick = function($event, inter) {\n        if ($scope.contextMenu.active)\n            return $scope.contextMenu.close();\n        /*        if (doubleClick) {\n                  return   \n\n                } */\n        if ($event.metaKey || $event.ctrlKey) {\n            tabContainer.addTab('/intervention/' + inter.id, {\n                title: ('#' + inter.id),\n                setFocus: false,\n                allowDuplicates: false\n            });\n        } else {\n            if ($rootScope.expendedRow === inter.id) {\n                $rootScope.expendedRow = -1;\n            } else {\n                $q.all([\n                    edisonAPI.intervention.get(inter.id),\n                    edisonAPI.artisan.getStats(inter.ai)\n                ]).then(function(result) {\n                    $rootScope.expendedRow = inter.id;\n                    $rootScope.expendedRowData = result[0].data;\n                    $rootScope.expendedRowData.artisanStats = result[1].data\n                })\n            }\n        }\n    }\n\n});\n"],"sourceRoot":"/source/"}